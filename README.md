# Sp-PokerGame

一个基于 Flask 的四人中文扑克牌小游戏（1 名玩家 + 3 名 AI）。

## 功能特性
- **完整对局流程**：发牌、首轮方块 3 限制、轮流出牌、过牌、胜负判定。
- **多种牌型支持**：单张、对子、三条、三带二、顺子、连对、炸弹、飞机。
- **AI 思考日志**：后端会打印每位 AI 的决策过程，便于调试和观察策略。
- **前后端分离接口**：通过 `/api/new_game`、`/api/play`、`/api/pass_turn` 完成交互。

## AI 增强点（本版本）
- **一手出完识别**：自由出牌时若整手牌是合法牌型，AI 会直接一手清空。
- **收尾预判**：跟单/跟对/跟三条时，优先选择“本轮压住 + 剩余牌可一手打完”的方案。
- **碎牌处理优化**：当手牌孤张偏多时，优先处理孤张，降低被卡手概率。


## 游戏规则（简版）
- **玩家人数**：4 人（你 + 3 个 AI）。
- **发牌**：52 张牌平均发给 4 位玩家，每人 13 张。
- **先手规则**：持有 **方块 3** 的玩家首轮先出，且首手牌必须包含方块 3。
- **可出牌型**：单张、对子、三条、三带二、顺子、连对、炸弹、飞机。
- **跟牌规则**：
  - 非自由回合时，必须与上一手 **同牌型、同张数** 且点数更大才能压住。
  - 炸弹可压除更大炸弹外的任意牌型；炸弹对炸弹时比点数大小。
- **过牌规则**：自由出牌玩家不能过牌；其余玩家可选择“不出”。
- **重置轮次**：连续 3 家过牌后，牌桌清空，下一位玩家获得自由出牌权。
- **胜利条件**：最先把手牌全部打完的玩家获胜。


## 安装与运行
### 1) 安装依赖
```bash
pip install flask
```

### 2) 启动项目
```bash
python app.py
```

默认访问地址：`http://127.0.0.1:5000`

## 项目结构
```text
Sp-PokerGame/
├── app.py              # Flask 服务与 API
├── game_logic.py       # 牌型判定、回合与胜负逻辑
├── ai_player.py        # AI 决策策略
├── templates/
│   └── index.html      # 页面
└── static/
    ├── css/style.css
    └── js/game.js
```

## 主要接口
- `POST /api/new_game`：创建并返回新对局状态。
- `POST /api/play`：玩家出牌。
- `POST /api/pass_turn`：玩家选择不出。

## 说明
- 当前版本主要关注玩法与 AI 可解释性（通过日志输出）。
- 若要增强竞技性，可继续加入：记牌、概率估计、蒙特卡洛模拟等高级策略。

## 资源配置：扑克牌图片
- 支持将你的本地扑克牌图片放在：`static/cards/`。
- 文件命名规则：`SpadeN`、`HeartN`、`DiamondN`、`ClubN`（后缀默认 `.png`）。
- 其中 `N` 为牌面数值，当前映射为：
  - `J/Q/K/A` 直接使用字母（不转换数字）
  - 其余牌按数字本身（如 `2`、`3`、`10`）。
- 示例：`SpadeA.png`、`HeartJ.png`、`Diamond10.png`、`ClubK.png`。
- 若对应图片不存在，系统会自动回退到内置矢量卡牌样式。

## AI 历史牌局增强
- AI 会读取最近出牌历史（最近 12 手），关注：
  - 对手最近过牌次数
  - A/2 等高牌已出现数量
  - 炸弹出现次数
- 决策时会基于这些历史信息调整进攻强度与跟牌保留策略。
=======
